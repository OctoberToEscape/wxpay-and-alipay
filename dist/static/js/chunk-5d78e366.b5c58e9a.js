(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5d78e366"],{"09fe":function(e,t,c){},"0a6e":function(e,t,c){},"0bce":function(e,t,c){},2381:function(e,t,c){},"2bb4":function(e,t,c){"use strict";c("68ef"),c("cb51"),c("3743"),c("09fe")},"3a10":function(e,t,c){"use strict";c.d(t,"f",(function(){return r})),c.d(t,"d",(function(){return s})),c.d(t,"k",(function(){return l})),c.d(t,"a",(function(){return i})),c.d(t,"h",(function(){return d})),c.d(t,"b",(function(){return u})),c.d(t,"g",(function(){return b})),c.d(t,"e",(function(){return m})),c.d(t,"c",(function(){return f})),c.d(t,"j",(function(){return O})),c.d(t,"i",(function(){return p}));var n=c("b775"),o=c("4328"),a=c.n(o);const r=e=>n["a"].post("/WebOrder/goods",a.a.stringify(e)).then(e=>e.data),s=e=>n["a"].post("/WebOrder/getOpenid",a.a.stringify(e)).then(e=>e),l=e=>n["a"].post("/WebOrder/addOrder",a.a.stringify(e)).then(e=>e),i=e=>n["a"].post("/webOrder/addOrder",a.a.stringify(e)).then(e=>e),d=e=>n["a"].post("/webOrder/queryOrder",a.a.stringify(e)).then(e=>e),u=e=>n["a"].post("/WebOrder/cannelOrder",a.a.stringify(e)).then(e=>e),b=e=>n["a"].post("/WebOrder/pay_success",a.a.stringify(e)).then(e=>e.data),m=e=>n["a"].post("/user/editRealname",a.a.stringify(e)).then(e=>e),f=e=>n["a"].post("/SmallAddress/getAddress",a.a.stringify(e)).then(e=>e.data),O=e=>n["a"].post("/SmallAddress/addAddress",a.a.stringify(e)).then(e=>e),p=e=>n["a"].post("/WebOrder/info",a.a.stringify(e)).then(e=>e.data)},"40db":function(e,t,c){},"42db":function(e,t,c){"use strict";c("68ef"),c("cb51"),c("3743"),c("dc1b"),c("2381"),c("dde9")},"4d86":function(e,t,c){"use strict";c("68ef"),c("5c56")},"5c56":function(e,t,c){},"634a":function(e,t,c){"use strict";c.r(t);var n=c("7336"),o=c("2e1b"),a=(c("22fa"),c("cdc2")),r=(c("68ef"),c("40db"),c("b730")),s=(c("cb51"),c("3743"),c("0a6e"),c("2381"),c("fe02")),l=(c("9c88"),c("6c44")),i=(c("1a04"),c("5d54")),d=(c("42db"),c("9a1c")),u=(c("89a0"),c("a136")),b=(c("4d86"),c("f23a")),m=(c("21a7"),c("aee2")),f=(c("2bb4"),c("dc94")),O=(c("02ab"),c("7a23"));const p=e=>(Object(O["pushScopeId"])("data-v-6bfe61cc"),e=e(),Object(O["popScopeId"])(),e),j={class:"order-index"},h={class:"course-content mb-20"},g=p(()=>Object(O["createElementVNode"])("div",{class:"title"},"课程详情",-1)),y={class:"info"},v={class:"left mr-20"},w={class:"right"},_={class:"course-title"},V={class:"price"},N={class:"now-price mr-20"},B={class:"old-price"},C={class:"real-name mb-20"},k=p(()=>Object(O["createElementVNode"])("div",{class:"name-left"},[Object(O["createElementVNode"])("div",{class:"text mb-10"},"真实姓名（必填项）"),Object(O["createElementVNode"])("div",{class:"tips"},"请填写真实姓名")],-1)),x={class:"pay-price mb-20"},E={class:"price-old mb-25"},S=p(()=>Object(O["createElementVNode"])("div",{class:"text"},"课程单价",-1)),D={class:"value"},q={class:"price-new"},I=p(()=>Object(O["createElementVNode"])("div",{class:"text"},"限时特价",-1)),T={class:"value active"},W={class:"choose-pay mb-20"},P=p(()=>Object(O["createElementVNode"])("div",{class:"title mb-40"},"支付方式",-1)),A=p(()=>Object(O["createElementVNode"])("span",{class:"ml-10"},"微信支付",-1)),R=p(()=>Object(O["createElementVNode"])("span",{class:"ml-10"},"支付宝支付",-1)),H={class:"rules"},J=p(()=>Object(O["createElementVNode"])("span",null,"已阅读并同意",-1)),z={class:"pay-bottom-btn"},F={key:0,class:"left"},U=p(()=>Object(O["createElementVNode"])("div",{class:"text mb-10"},"特价倒计时",-1)),M=Object(O["createTextVNode"])("立即支付");function L(e,t,c,p,L,$){const K=f["a"],G=m["a"],Q=b["a"],X=u["a"],Y=d["a"],Z=i["a"],ee=l["a"],te=s["a"],ce=r["a"],ne=a["a"],oe=o["a"],ae=n["a"];return Object(O["openBlock"])(),Object(O["createElementBlock"])("div",j,[e.wechat?Object(O["createCommentVNode"])("",!0):(Object(O["openBlock"])(),Object(O["createBlock"])(K,{key:0,title:e.course.channel_name,"safe-area-inset-top":"",fixed:"",placeholder:""},null,8,["title"])),Object(O["createElementVNode"])("main",null,[Object(O["createElementVNode"])("div",h,[g,Object(O["createElementVNode"])("div",y,[Object(O["createElementVNode"])("div",v,[Object(O["createVNode"])(G,{fit:"cover",width:"100%",height:"100%",radius:".16rem",src:e.course.bg_url},null,8,["src"])]),Object(O["createElementVNode"])("div",w,[Object(O["createElementVNode"])("div",_,Object(O["toDisplayString"])(e.course.name),1),Object(O["createElementVNode"])("div",V,[Object(O["createElementVNode"])("div",N,"￥"+Object(O["toDisplayString"])(e.course.rprice),1),Object(O["createElementVNode"])("div",B,"￥"+Object(O["toDisplayString"])(e.course.price),1)])])])]),Object(O["createElementVNode"])("div",C,[k,Object(O["createVNode"])(X,{inset:""},{default:Object(O["withCtx"])(()=>[Object(O["createVNode"])(Q,{modelValue:e.course.real_name,"onUpdate:modelValue":t[0]||(t[0]=t=>e.course.real_name=t),placeholder:"请输入姓名",autocomplete:"off",maxlength:"12"},null,8,["modelValue"])]),_:1})]),Object(O["createElementVNode"])("div",x,[Object(O["createElementVNode"])("div",E,[S,Object(O["createElementVNode"])("div",D,"￥"+Object(O["toDisplayString"])(e.course.price),1)]),Object(O["createElementVNode"])("div",q,[I,Object(O["createElementVNode"])("div",T,"￥"+Object(O["toDisplayString"])(e.course.preferential_price),1)])]),Object(O["createElementVNode"])("div",W,[P,Object(O["createVNode"])(te,{modelValue:e.payChoose,"onUpdate:modelValue":t[3]||(t[3]=t=>e.payChoose=t)},{default:Object(O["withCtx"])(()=>[Object(O["createVNode"])(X,{border:!1},{default:Object(O["withCtx"])(()=>[Object(O["createVNode"])(ee,{clickable:"",onClick:t[1]||(t[1]=t=>e.payChoose="1"),border:!1},{title:Object(O["withCtx"])(()=>[Object(O["createVNode"])(Y,{name:"wechat-pay",size:".52rem",color:"#09bb07"}),A]),"right-icon":Object(O["withCtx"])(()=>[Object(O["createVNode"])(Z,{name:"1","checked-color":"#ff3737"})]),_:1}),e.wechat?Object(O["createCommentVNode"])("",!0):(Object(O["openBlock"])(),Object(O["createBlock"])(ee,{key:0,clickable:"",onClick:t[2]||(t[2]=t=>e.payChoose="2"),border:!1},{title:Object(O["withCtx"])(()=>[Object(O["createVNode"])(Y,{name:"alipay",size:".52rem",color:"#108ee9"}),R]),"right-icon":Object(O["withCtx"])(()=>[Object(O["createVNode"])(Z,{name:"2","checked-color":"#ff3737"})]),_:1}))]),_:1})]),_:1},8,["modelValue"])]),Object(O["createElementVNode"])("div",H,[Object(O["createVNode"])(ce,{modelValue:e.checked,"onUpdate:modelValue":t[5]||(t[5]=t=>e.checked=t),"checked-color":"#ff3737","icon-size":".32rem"},{default:Object(O["withCtx"])(()=>[J,Object(O["createElementVNode"])("span",{class:"active",onClick:t[4]||(t[4]=Object(O["withModifiers"])(t=>e.ruleShow=!0,["stop"]))},"《光环课程支付协议》")]),_:1},8,["modelValue"])])]),Object(O["createElementVNode"])("div",z,[e.course.end_time-e.course.system_time>0?(Object(O["openBlock"])(),Object(O["createElementBlock"])("div",F,[U,Object(O["createVNode"])(ne,{time:1e3*(e.course.end_time-e.course.system_time),format:"DD 天 HH : mm : ss",onFinish:e.finish},null,8,["time","onFinish"])])):Object(O["createCommentVNode"])("",!0),Object(O["createElementVNode"])("div",{class:Object(O["normalizeClass"])(e.course.end_time-e.course.system_time>0?"right-mini ":"right-lang")},[Object(O["createVNode"])(oe,{color:"#FF3737",round:"",block:"",onClick:e.handleBuy},{default:Object(O["withCtx"])(()=>[M]),_:1},8,["onClick"])],2)]),Object(O["createVNode"])(ae,{show:e.ruleShow,rich:e.course.agreement_content,onOnClose:t[6]||(t[6]=t=>e.ruleShow=!1)},null,8,["show","rich"])])}var $=c("4360"),K=c("6c02"),G=c("6c43"),Q=c("fa7c"),X=c("23f9"),Y=c("6872"),Z=c("1fba"),ee=c("e5f6"),te=c("9b55"),ce=c("b75f"),ne=c("d243"),oe=c("5aa0"),ae=c("eec6"),re=c("5f24"),se=c("450f");const[le,ie]=Object(Z["a"])("action-bar"),de=Symbol(le),ue={safeAreaInsetBottom:ee["g"]};var be=Object(O["defineComponent"])({name:le,props:ue,setup(e,{slots:t}){const{linkChildren:c}=Object(se["useChildren"])(de);return c(),()=>{var c;return Object(O["createVNode"])("div",{class:[ie(),{"van-safe-area-bottom":e.safeAreaInsetBottom}]},[null==(c=t.default)?void 0:c.call(t)])}}});const me=Object(X["a"])(be);var fe=c("efd9"),Oe=c("4e5e");const[pe,je]=Object(Z["a"])("action-bar-button"),he=Object(Q["a"])({},Oe["a"],{type:String,text:String,icon:String,color:String,loading:Boolean,disabled:Boolean});var ge=Object(O["defineComponent"])({name:pe,props:he,setup(e,{slots:t}){const c=Object(Oe["b"])(),{parent:n,index:a}=Object(se["useParent"])(de),r=Object(O["computed"])(()=>{if(n){const e=n.children[a.value-1];return!(e&&"isButton"in e)}}),s=Object(O["computed"])(()=>{if(n){const e=n.children[a.value+1];return!(e&&"isButton"in e)}});return Object(fe["a"])({isButton:!0}),()=>{const{type:n,icon:a,text:l,color:i,loading:d,disabled:u}=e;return Object(O["createVNode"])(o["a"],{class:je([n,{last:s.value,first:r.value}]),size:"large",type:n,icon:a,color:i,loading:d,disabled:u,onClick:c},{default:()=>[t.default?t.default():l]})}}});const ye=Object(X["a"])(ge);const[ve,we,_e]=Object(Z["a"])("dialog"),Ve=Object(Q["a"])({},ae["b"],{title:String,theme:String,width:ee["f"],message:[String,Function],callback:Function,allowHtml:Boolean,className:ee["h"],transition:Object(ee["e"])("van-dialog-bounce"),messageAlign:String,closeOnPopstate:ee["g"],showCancelButton:Boolean,cancelButtonText:String,cancelButtonColor:String,cancelButtonDisabled:Boolean,confirmButtonText:String,confirmButtonColor:String,confirmButtonDisabled:Boolean,showConfirmButton:ee["g"],closeOnClickOverlay:Boolean}),Ne=[...ae["a"],"transition","closeOnPopstate"];var Be=Object(O["defineComponent"])({name:ve,props:Ve,emits:["confirm","cancel","keydown","update:show"],setup(e,{emit:t,slots:c}){const n=Object(O["ref"])(),a=Object(O["reactive"])({confirm:!1,cancel:!1}),r=e=>t("update:show",e),s=t=>{var c;r(!1),null==(c=e.callback)||c.call(e,t)},l=c=>()=>{e.show&&(t(c),e.beforeClose?(a[c]=!0,Object(te["a"])(e.beforeClose,{args:[c],done(){s(c),a[c]=!1},canceled(){a[c]=!1}})):s(c))},i=l("cancel"),d=l("confirm"),u=Object(O["withKeys"])(c=>{var o,a;if(c.target!==(null==(a=null==(o=n.value)?void 0:o.popupRef)?void 0:a.value))return;const r={Enter:e.showConfirmButton?d:Q["d"],Escape:e.showCancelButton?i:Q["d"]};r[c.key](),t("keydown",c)},["enter","esc"]),b=()=>{const t=c.title?c.title():e.title;if(t)return Object(O["createVNode"])("div",{class:we("header",{isolated:!e.message&&!c.default})},[t])},m=t=>{const{message:c,allowHtml:n,messageAlign:o}=e,a=we("message",{"has-title":t,[o]:o}),r=Object(ce["b"])(c)?c():c;return n&&"string"===typeof r?Object(O["createVNode"])("div",{class:a,innerHTML:r},null):Object(O["createVNode"])("div",{class:a},[r])},f=()=>{if(c.default)return Object(O["createVNode"])("div",{class:we("content")},[c.default()]);const{title:t,message:n,allowHtml:o}=e;if(n){const e=!(!t&&!c.title);return Object(O["createVNode"])("div",{key:o?1:0,class:we("content",{isolated:!e})},[m(e)])}},p=()=>Object(O["createVNode"])("div",{class:[ne["d"],we("footer")]},[e.showCancelButton&&Object(O["createVNode"])(o["a"],{size:"large",text:e.cancelButtonText||_e("cancel"),class:we("cancel"),style:{color:e.cancelButtonColor},loading:a.cancel,disabled:e.cancelButtonDisabled,onClick:i},null),e.showConfirmButton&&Object(O["createVNode"])(o["a"],{size:"large",text:e.confirmButtonText||_e("confirm"),class:[we("confirm"),{[ne["b"]]:e.showCancelButton}],style:{color:e.confirmButtonColor},loading:a.confirm,disabled:e.confirmButtonDisabled,onClick:d},null)]),j=()=>Object(O["createVNode"])(me,{class:we("footer")},{default:()=>[e.showCancelButton&&Object(O["createVNode"])(ye,{type:"warning",text:e.cancelButtonText||_e("cancel"),class:we("cancel"),color:e.cancelButtonColor,loading:a.cancel,disabled:e.cancelButtonDisabled,onClick:i},null),e.showConfirmButton&&Object(O["createVNode"])(ye,{type:"danger",text:e.confirmButtonText||_e("confirm"),class:we("confirm"),color:e.confirmButtonColor,loading:a.confirm,disabled:e.confirmButtonDisabled,onClick:d},null)]}),h=()=>c.footer?c.footer():"round-button"===e.theme?j():p();return()=>{const{width:t,title:c,theme:o,message:a,className:s}=e;return Object(O["createVNode"])(re["a"],Object(O["mergeProps"])({ref:n,role:"dialog",class:[we([o]),s],style:{width:Object(oe["a"])(t)},tabindex:0,"aria-labelledby":c||a,onKeydown:u,"onUpdate:show":r},Object(Q["e"])(e,Ne)),{default:()=>[b(),f(),h()]})}}});let Ce;function ke(){const e={setup(){const{state:e,toggle:t}=Object(Y["b"])();return()=>Object(O["createVNode"])(Be,Object(O["mergeProps"])(e,{"onUpdate:show":t}),null)}};({instance:Ce}=Object(Y["a"])(e))}function xe(e){return Q["c"]?new Promise((t,c)=>{Ce||ke(),Ce.open(Object(Q["a"])({},xe.currentOptions,e,{callback:e=>{("confirm"===e?t:c)(e)}}))}):Promise.resolve()}xe.defaultOptions={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,cancelButtonDisabled:!1,confirmButtonText:"",confirmButtonColor:null,confirmButtonDisabled:!1,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1},xe.currentOptions=Object(Q["a"])({},xe.defaultOptions),xe.alert=xe,xe.confirm=e=>xe(Object(Q["a"])({showCancelButton:!0},e)),xe.close=()=>{Ce&&Ce.toggle(!1)},xe.setDefaultOptions=e=>{Object(Q["a"])(xe.currentOptions,e)},xe.resetDefaultOptions=()=>{xe.currentOptions=Object(Q["a"])({},xe.defaultOptions)},xe.Component=Object(X["a"])(Be),xe.install=e=>{e.use(xe.Component),e.config.globalProperties.$dialog=xe};var Ee=c("cf45"),Se=c("3a10"),De=Object(O["defineComponent"])({name:"order-index",components:{rulePopup:n["a"]},setup(){const e=Object(K["d"])(),t=Object(K["c"])(),c=Object(O["ref"])(!1),n=Object(O["ref"])(!1),o=Object(O["ref"])("1"),a=Object(O["ref"])(""),r=Object(O["reactive"])({course:{}}),s=()=>{let{channel_id:c}=t.query;Object(Se["f"])({channel_id:c,uid:$["a"].state.userInfo?$["a"].state.userInfo.id:""}).then(t=>{t&&(r.course=t,document.title=t.channel_name,0!==t.end_time&&t.end_time-t.system_time<=0&&e.push({name:"error",query:{type:"search",title:"当前活动已过期～"}}))})},l=c=>{Object(G["a"])({message:c+",跳转支付结果页..."}),setTimeout(()=>{e.push({name:"pay-success",query:{order_num:t.query.order_num||r.course.order_num}})},1500)},i=()=>{const t=localStorage.userInfo;if(t){if(!r.course.real_name)return void Object(G["a"])("请填写真实姓名");if(!c.value)return void Object(G["a"])("请同意支付协议");"1"===o.value?d():j()}else e.push({name:"login"})},d=()=>{h.value?localStorage.OPENID?b():u():m()},u=()=>{a.value=Object(Ee["a"])("code"),null==a.value||""===a.value?window.location.href=`https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx2aa465e8ca0f0986&redirect_uri=${encodeURIComponent(window.location.href)}&response_type=code&scope=snsapi_userinfo#wechat_redirect`:Object(Se["d"])({code:a.value}).then(e=>{1===e.status&&(localStorage.OPENID=e.data.openid,b())})},b=()=>{Object(Se["k"])({channel_id:t.query.channel_id,uid:$["a"].state.userInfo.id,pay_method:2,if_wechat_browser:1,real_name:r.course.real_name,openid:localStorage.OPENID}).then(e=>{1===e.status?f(e.data):3===e.status?l(e.msg):4===e.status&&Object(G["a"])(e.msg)})},m=()=>{Object(Se["k"])({channel_id:t.query.channel_id,uid:$["a"].state.userInfo.id,pay_method:2,if_wechat_browser:0,real_name:r.course.real_name,redirect_url:`${window.location.origin}/aura-h5/payment?channel_id=${t.query.channel_id}`}).then(e=>{1===e.status?window.location.href=e.data.mweb_url:3===e.status?l(e.msg):4===e.status&&Object(G["a"])(e.msg)})},f=e=>{var t={appId:e.appid,timeStamp:e.timestamp,nonceStr:e.noncestr,package:e.package,signType:"MD5",paySign:e.sign2,order_num:e.order_num};"undifine"==typeof WeixinJSBbridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",p(t),!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",p(t)),document.attachEvent("OnWeixinJSBridgeReady",p(t))):p(t)},p=t=>{WeixinJSBridge.invoke("getBrandWCPayRequest",t,(function(c){"get_brand_wcpay_request:ok"==c.err_msg?(G["a"].success("支付成功"),setTimeout(()=>{e.push({name:"pay-success",query:{order_num:t.order_num}})},1500)):Object(Se["b"])({order_num:t.order_num,uid:$["a"].state.userInfo.id}).then(e=>{1===e.status&&Object(G["a"])({message:"支付失败"})})}))},j=()=>{Object(Se["a"])({channel_id:t.query.channel_id,uid:$["a"].state.userInfo.id,pay_method:1,real_name:r.course.real_name,redirect_url:window.origin+"/aura-h5/pay-success?order_num="}).then(e=>{if("string"===typeof e){const t=document.createElement("div");t.innerHTML=e,document.body.appendChild(t),document.forms[0].submit()}else"object"===typeof e&&3===e.status?l(e.msg):"object"===typeof e&&4===e.status&&Object(G["a"])(e.msg)})},h=Object(O["computed"])(()=>$["a"].state.isWechat),g=()=>s();return Object(O["onMounted"])(()=>{s(),t.query.isAlert&&"1"===t.query.isAlert&&xe.confirm({title:"提示",message:"请确认微信支付是否已经完成",confirmButtonText:"已完成支付",cancelButtonText:"重新支付"}).then(()=>{Object(Se["h"])({order_num:t.query.order_num}).then(c=>{1===c.status&&e.push({name:"pay-success",query:{order_num:t.query.order_num}})})}).catch(()=>{m()})}),{code:a,checked:c,ruleShow:n,payChoose:o,wechat:h,...Object(O["toRefs"])(r),routerJump:l,handleBuy:i,getWxCode:u,wxpayRequest:b,wechatPay:d,getWxH5:m,getWxJSSDK:f,onBridgeReady:p,alipay:j,finish:g}}}),qe=(c("88ea"),c("6b0d")),Ie=c.n(qe);const Te=Ie()(De,[["render",L],["__scopeId","data-v-6bfe61cc"]]);t["default"]=Te},"88ea":function(e,t,c){"use strict";c("0bce")},"9c88":function(e,t,c){"use strict";c("68ef"),c("dc1b")},dc1b:function(e,t,c){},dde9:function(e,t,c){}}]);