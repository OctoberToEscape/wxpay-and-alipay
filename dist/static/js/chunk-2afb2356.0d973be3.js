(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2afb2356"],{"16f8":function(e,t,o){"use strict";o("70f9")},"1c79":function(e,t,o){},"3a10":function(e,t,o){"use strict";o.d(t,"f",(function(){return r})),o.d(t,"d",(function(){return l})),o.d(t,"k",(function(){return s})),o.d(t,"a",(function(){return i})),o.d(t,"h",(function(){return d})),o.d(t,"b",(function(){return u})),o.d(t,"g",(function(){return b})),o.d(t,"e",(function(){return m})),o.d(t,"c",(function(){return O})),o.d(t,"j",(function(){return p})),o.d(t,"i",(function(){return f}));var n=o("b775"),c=o("4328"),a=o.n(c);const r=e=>n["a"].post("/WebOrder/goods",a.a.stringify(e)).then(e=>e.data),l=e=>n["a"].post("/WebOrder/getOpenid",a.a.stringify(e)).then(e=>e),s=e=>n["a"].post("/WebOrder/addOrder",a.a.stringify(e)).then(e=>e),i=e=>n["a"].post("/webOrder/addOrder",a.a.stringify(e)).then(e=>e),d=e=>n["a"].post("/webOrder/queryOrder",a.a.stringify(e)).then(e=>e),u=e=>n["a"].post("/WebOrder/cannelOrder",a.a.stringify(e)).then(e=>e),b=e=>n["a"].post("/WebOrder/pay_success",a.a.stringify(e)).then(e=>e.data),m=e=>n["a"].post("/user/editRealname",a.a.stringify(e)).then(e=>e),O=e=>n["a"].post("/SmallAddress/getAddress",a.a.stringify(e)).then(e=>e.data),p=e=>n["a"].post("/SmallAddress/addAddress",a.a.stringify(e)).then(e=>e),f=e=>n["a"].post("/WebOrder/info",a.a.stringify(e)).then(e=>e.data)},"634a":function(e,t,o){"use strict";o.r(t);var n=o("7a23");const c=e=>(Object(n["pushScopeId"])("data-v-3f20e2da"),e=e(),Object(n["popScopeId"])(),e),a={class:"order-index"},r={class:"course-content mb-20"},l=c(()=>Object(n["createElementVNode"])("div",{class:"title"},"课程详情",-1)),s={class:"info"},i={class:"left mr-20"},d={class:"right"},u={class:"course-title"},b={class:"price"},m={class:"now-price mr-20"},O={class:"old-price"},p={key:0,class:"real-name mb-20"},f=c(()=>Object(n["createElementVNode"])("div",{class:"name-left"},[Object(n["createElementVNode"])("div",{class:"text mb-10"},"真实姓名（必填项）"),Object(n["createElementVNode"])("div",{class:"tips"},"请填写真实姓名")],-1)),j={class:"pay-price mb-20"},h={class:"price-old mb-25"},v=c(()=>Object(n["createElementVNode"])("div",{class:"text"},"课程单价",-1)),g={class:"value"},y={class:"price-new"},w=c(()=>Object(n["createElementVNode"])("div",{class:"text"},"限时特价",-1)),C={class:"value active"},_={class:"choose-pay mb-20"},V=c(()=>Object(n["createElementVNode"])("div",{class:"title mb-40"},"支付方式",-1)),N=c(()=>Object(n["createElementVNode"])("span",{class:"ml-10"},"微信支付",-1)),B=c(()=>Object(n["createElementVNode"])("span",{class:"ml-10"},"支付宝支付",-1)),k={key:1,class:"rules"},E=c(()=>Object(n["createElementVNode"])("span",null,"已阅读并同意",-1)),x={class:"pay-bottom-btn"},S={key:0,class:"left"},D=c(()=>Object(n["createElementVNode"])("div",{class:"text mb-10"},"特价倒计时",-1)),I=Object(n["createTextVNode"])("立即支付");function q(e,t,o,c,q,T){const W=Object(n["resolveComponent"])("van-nav-bar"),P=Object(n["resolveComponent"])("van-image"),H=Object(n["resolveComponent"])("van-field"),R=Object(n["resolveComponent"])("van-cell-group"),A=Object(n["resolveComponent"])("van-icon"),U=Object(n["resolveComponent"])("van-radio"),J=Object(n["resolveComponent"])("van-cell"),L=Object(n["resolveComponent"])("van-radio-group"),z=Object(n["resolveComponent"])("van-checkbox"),M=Object(n["resolveComponent"])("van-count-down"),F=Object(n["resolveComponent"])("van-button"),$=Object(n["resolveComponent"])("rule-popup");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",a,[e.wechat?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createBlock"])(W,{key:0,title:e.course.channel_name,"safe-area-inset-top":"",fixed:"",placeholder:""},null,8,["title"])),Object(n["createElementVNode"])("main",null,[Object(n["createElementVNode"])("div",r,[l,Object(n["createElementVNode"])("div",s,[Object(n["createElementVNode"])("div",i,[Object(n["createVNode"])(P,{fit:"cover",width:"100%",height:"100%",radius:".16rem",src:e.course.bg_url},null,8,["src"])]),Object(n["createElementVNode"])("div",d,[Object(n["createElementVNode"])("div",u,Object(n["toDisplayString"])(e.course.name),1),Object(n["createElementVNode"])("div",b,[Object(n["createElementVNode"])("div",m,"￥"+Object(n["toDisplayString"])(e.course.preferential_price),1),Object(n["createElementVNode"])("div",O,"￥"+Object(n["toDisplayString"])(e.course.price),1)])])])]),e.RULESHOW?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",p,[f,Object(n["createVNode"])(R,{inset:""},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(H,{modelValue:e.course.real_name,"onUpdate:modelValue":t[0]||(t[0]=t=>e.course.real_name=t),placeholder:"请输入姓名",autocomplete:"off",maxlength:"12"},null,8,["modelValue"])]),_:1})])):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("div",j,[Object(n["createElementVNode"])("div",h,[v,Object(n["createElementVNode"])("div",g,"￥"+Object(n["toDisplayString"])(e.course.price),1)]),Object(n["createElementVNode"])("div",y,[w,Object(n["createElementVNode"])("div",C,"￥"+Object(n["toDisplayString"])(e.course.preferential_price),1)])]),Object(n["createElementVNode"])("div",_,[V,Object(n["createVNode"])(L,{modelValue:e.payChoose,"onUpdate:modelValue":t[3]||(t[3]=t=>e.payChoose=t)},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(R,{border:!1},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(J,{clickable:"",onClick:t[1]||(t[1]=t=>e.payChoose="1"),border:!1},{title:Object(n["withCtx"])(()=>[Object(n["createVNode"])(A,{name:"wechat-pay",size:".52rem",color:"#09bb07"}),N]),"right-icon":Object(n["withCtx"])(()=>[Object(n["createVNode"])(U,{name:"1","checked-color":"#ff3737"})]),_:1}),e.wechat?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createBlock"])(J,{key:0,clickable:"",onClick:t[2]||(t[2]=t=>e.payChoose="2"),border:!1},{title:Object(n["withCtx"])(()=>[Object(n["createVNode"])(A,{name:"alipay",size:".52rem",color:"#108ee9"}),B]),"right-icon":Object(n["withCtx"])(()=>[Object(n["createVNode"])(U,{name:"2","checked-color":"#ff3737"})]),_:1}))]),_:1})]),_:1},8,["modelValue"])]),e.RULESHOW?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",k,[Object(n["createVNode"])(z,{modelValue:e.checked,"onUpdate:modelValue":t[5]||(t[5]=t=>e.checked=t),"checked-color":"#ff3737","icon-size":".32rem"},{default:Object(n["withCtx"])(()=>[E,Object(n["createElementVNode"])("span",{class:"active",onClick:t[4]||(t[4]=Object(n["withModifiers"])(t=>e.ruleShow=!0,["stop"]))},"《光环课程支付协议》")]),_:1},8,["modelValue"])])):Object(n["createCommentVNode"])("",!0)]),Object(n["createElementVNode"])("div",x,[e.course.end_time-e.course.system_time>0?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",S,[D,Object(n["createVNode"])(M,{time:1e3*(e.course.end_time-e.course.system_time),format:"DD 天 HH : mm : ss",onFinish:e.finish},null,8,["time","onFinish"])])):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("div",{class:Object(n["normalizeClass"])(e.course.end_time-e.course.system_time>0?"right-mini ":"right-lang")},[Object(n["createVNode"])(F,{color:"#FF3737",round:"",block:"",onClick:e.handleBuy},{default:Object(n["withCtx"])(()=>[I]),_:1},8,["onClick"])],2)]),Object(n["createVNode"])($,{show:e.ruleShow,rich:e.course.agreement_content,onOnClose:t[6]||(t[6]=t=>e.ruleShow=!1)},null,8,["show","rich"])])}var T=o("7336"),W=o("4360"),P=o("6c02"),H=o("6c43"),R=o("fa7c"),A=o("23f9"),U=o("6872"),J=o("1fba"),L=o("e5f6"),z=o("9b55"),M=o("b75f"),F=o("d243"),$=o("5aa0"),K=o("eec6"),G=o("5f24"),Q=o("2e1b"),X=o("450f");const[Y,Z]=Object(J["a"])("action-bar"),ee=Symbol(Y),te={safeAreaInsetBottom:L["g"]};var oe=Object(n["defineComponent"])({name:Y,props:te,setup(e,{slots:t}){const{linkChildren:o}=Object(X["useChildren"])(ee);return o(),()=>{var o;return Object(n["createVNode"])("div",{class:[Z(),{"van-safe-area-bottom":e.safeAreaInsetBottom}]},[null==(o=t.default)?void 0:o.call(t)])}}});const ne=Object(A["a"])(oe);var ce=o("efd9"),ae=o("4e5e");const[re,le]=Object(J["a"])("action-bar-button"),se=Object(R["a"])({},ae["a"],{type:String,text:String,icon:String,color:String,loading:Boolean,disabled:Boolean});var ie=Object(n["defineComponent"])({name:re,props:se,setup(e,{slots:t}){const o=Object(ae["b"])(),{parent:c,index:a}=Object(X["useParent"])(ee),r=Object(n["computed"])(()=>{if(c){const e=c.children[a.value-1];return!(e&&"isButton"in e)}}),l=Object(n["computed"])(()=>{if(c){const e=c.children[a.value+1];return!(e&&"isButton"in e)}});return Object(ce["a"])({isButton:!0}),()=>{const{type:c,icon:a,text:s,color:i,loading:d,disabled:u}=e;return Object(n["createVNode"])(Q["a"],{class:le([c,{last:l.value,first:r.value}]),size:"large",type:c,icon:a,color:i,loading:d,disabled:u,onClick:o},{default:()=>[t.default?t.default():s]})}}});const de=Object(A["a"])(ie);const[ue,be,me]=Object(J["a"])("dialog"),Oe=Object(R["a"])({},K["b"],{title:String,theme:String,width:L["f"],message:[String,Function],callback:Function,allowHtml:Boolean,className:L["h"],transition:Object(L["e"])("van-dialog-bounce"),messageAlign:String,closeOnPopstate:L["g"],showCancelButton:Boolean,cancelButtonText:String,cancelButtonColor:String,cancelButtonDisabled:Boolean,confirmButtonText:String,confirmButtonColor:String,confirmButtonDisabled:Boolean,showConfirmButton:L["g"],closeOnClickOverlay:Boolean}),pe=[...K["a"],"transition","closeOnPopstate"];var fe=Object(n["defineComponent"])({name:ue,props:Oe,emits:["confirm","cancel","keydown","update:show"],setup(e,{emit:t,slots:o}){const c=Object(n["ref"])(),a=Object(n["reactive"])({confirm:!1,cancel:!1}),r=e=>t("update:show",e),l=t=>{var o;r(!1),null==(o=e.callback)||o.call(e,t)},s=o=>()=>{e.show&&(t(o),e.beforeClose?(a[o]=!0,Object(z["a"])(e.beforeClose,{args:[o],done(){l(o),a[o]=!1},canceled(){a[o]=!1}})):l(o))},i=s("cancel"),d=s("confirm"),u=Object(n["withKeys"])(o=>{var n,a;if(o.target!==(null==(a=null==(n=c.value)?void 0:n.popupRef)?void 0:a.value))return;const r={Enter:e.showConfirmButton?d:R["d"],Escape:e.showCancelButton?i:R["d"]};r[o.key](),t("keydown",o)},["enter","esc"]),b=()=>{const t=o.title?o.title():e.title;if(t)return Object(n["createVNode"])("div",{class:be("header",{isolated:!e.message&&!o.default})},[t])},m=t=>{const{message:o,allowHtml:c,messageAlign:a}=e,r=be("message",{"has-title":t,[a]:a}),l=Object(M["b"])(o)?o():o;return c&&"string"===typeof l?Object(n["createVNode"])("div",{class:r,innerHTML:l},null):Object(n["createVNode"])("div",{class:r},[l])},O=()=>{if(o.default)return Object(n["createVNode"])("div",{class:be("content")},[o.default()]);const{title:t,message:c,allowHtml:a}=e;if(c){const e=!(!t&&!o.title);return Object(n["createVNode"])("div",{key:a?1:0,class:be("content",{isolated:!e})},[m(e)])}},p=()=>Object(n["createVNode"])("div",{class:[F["d"],be("footer")]},[e.showCancelButton&&Object(n["createVNode"])(Q["a"],{size:"large",text:e.cancelButtonText||me("cancel"),class:be("cancel"),style:{color:e.cancelButtonColor},loading:a.cancel,disabled:e.cancelButtonDisabled,onClick:i},null),e.showConfirmButton&&Object(n["createVNode"])(Q["a"],{size:"large",text:e.confirmButtonText||me("confirm"),class:[be("confirm"),{[F["b"]]:e.showCancelButton}],style:{color:e.confirmButtonColor},loading:a.confirm,disabled:e.confirmButtonDisabled,onClick:d},null)]),f=()=>Object(n["createVNode"])(ne,{class:be("footer")},{default:()=>[e.showCancelButton&&Object(n["createVNode"])(de,{type:"warning",text:e.cancelButtonText||me("cancel"),class:be("cancel"),color:e.cancelButtonColor,loading:a.cancel,disabled:e.cancelButtonDisabled,onClick:i},null),e.showConfirmButton&&Object(n["createVNode"])(de,{type:"danger",text:e.confirmButtonText||me("confirm"),class:be("confirm"),color:e.confirmButtonColor,loading:a.confirm,disabled:e.confirmButtonDisabled,onClick:d},null)]}),j=()=>o.footer?o.footer():"round-button"===e.theme?f():p();return()=>{const{width:t,title:o,theme:a,message:l,className:s}=e;return Object(n["createVNode"])(G["a"],Object(n["mergeProps"])({ref:c,role:"dialog",class:[be([a]),s],style:{width:Object($["a"])(t)},tabindex:0,"aria-labelledby":o||l,onKeydown:u,"onUpdate:show":r},Object(R["e"])(e,pe)),{default:()=>[b(),O(),j()]})}}});let je;function he(){const e={setup(){const{state:e,toggle:t}=Object(U["b"])();return()=>Object(n["createVNode"])(fe,Object(n["mergeProps"])(e,{"onUpdate:show":t}),null)}};({instance:je}=Object(U["a"])(e))}function ve(e){return R["c"]?new Promise((t,o)=>{je||he(),je.open(Object(R["a"])({},ve.currentOptions,e,{callback:e=>{("confirm"===e?t:o)(e)}}))}):Promise.resolve()}ve.defaultOptions={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,cancelButtonDisabled:!1,confirmButtonText:"",confirmButtonColor:null,confirmButtonDisabled:!1,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1},ve.currentOptions=Object(R["a"])({},ve.defaultOptions),ve.alert=ve,ve.confirm=e=>ve(Object(R["a"])({showCancelButton:!0},e)),ve.close=()=>{je&&je.toggle(!1)},ve.setDefaultOptions=e=>{Object(R["a"])(ve.currentOptions,e)},ve.resetDefaultOptions=()=>{ve.currentOptions=Object(R["a"])({},ve.defaultOptions)},ve.Component=Object(A["a"])(fe),ve.install=e=>{e.use(ve.Component),e.config.globalProperties.$dialog=ve};var ge=o("cf45"),ye=o("3a10"),we=Object(n["defineComponent"])({name:"order-index",components:{rulePopup:T["a"]},setup(){const e=Object(P["d"])(),t=Object(P["c"])(),o=Object(n["ref"])(!1),c=Object(n["ref"])(!1),a=Object(n["ref"])("1"),r=Object(n["ref"])(""),l=Object(n["reactive"])({course:{}}),s=()=>{let{channel_id:o}=t.query;Object(ye["f"])({channel_id:o,uid:W["a"].state.userInfo?W["a"].state.userInfo.id:""}).then(t=>{t&&(l.course=t,document.title=t.channel_name,0!==t.end_time&&t.end_time-t.system_time<=0&&e.push({name:"error",query:{type:"search",title:"当前活动已过期～"}}))})},i=o=>{Object(H["a"])({message:o+",跳转支付结果页..."}),setTimeout(()=>{e.push({name:"pay-success",query:{order_num:t.query.order_num||l.course.order_num}})},1500)},d=()=>{const t=localStorage.userInfo;if(t){if(!localStorage.OPENID&&h.value)return void b();if(!l.course.real_name)return void Object(H["a"])("请填写真实姓名");if(!o.value)return void Object(H["a"])("请同意支付协议");"1"===a.value?u():j()}else e.push({name:"login"})},u=()=>{h.value?localStorage.OPENID?m():b():O()},b=()=>{r.value=Object(ge["a"])("code"),null==r.value||""===r.value?window.location.href=`https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx9804ea25d5e208e5&redirect_uri=${encodeURIComponent(window.location.href)}&response_type=code&scope=snsapi_userinfo#wechat_redirect`:Object(ye["d"])({code:r.value}).then(e=>{1===e.status&&(localStorage.OPENID=e.data.openid,m())})},m=()=>{Object(ye["k"])({channel_id:t.query.channel_id,uid:W["a"].state.userInfo.id,pay_method:2,if_wechat_browser:1,real_name:l.course.real_name,openid:localStorage.OPENID}).then(e=>{1===e.status?p(e.data):3===e.status?i(e.msg):4===e.status&&Object(H["a"])(e.msg)})},O=()=>{Object(ye["k"])({channel_id:t.query.channel_id,uid:W["a"].state.userInfo.id,pay_method:2,if_wechat_browser:0,real_name:l.course.real_name,redirect_url:`${window.location.origin}/aura-h5/payment?channel_id=${t.query.channel_id}`}).then(e=>{1===e.status?window.location.href=e.data.mweb_url:3===e.status?i(e.msg):4===e.status&&Object(H["a"])(e.msg)})},p=e=>{var t={appId:e.appid,timeStamp:e.timestamp,nonceStr:e.noncestr,package:e.package,signType:"MD5",paySign:e.sign2,order_num:e.order_num};"undifine"==typeof WeixinJSBbridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",f(t),!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",f(t)),document.attachEvent("OnWeixinJSBridgeReady",f(t))):f(t)},f=t=>{WeixinJSBridge.invoke("getBrandWCPayRequest",t,(function(o){"get_brand_wcpay_request:ok"==o.err_msg?(H["a"].success("支付成功"),setTimeout(()=>{e.push({name:"pay-success",query:{order_num:t.order_num}})},1500)):Object(ye["b"])({order_num:t.order_num,uid:W["a"].state.userInfo.id}).then(e=>{1===e.status&&Object(H["a"])({message:"支付失败"})})}))},j=()=>{Object(ye["a"])({channel_id:t.query.channel_id,uid:W["a"].state.userInfo.id,pay_method:1,real_name:l.course.real_name,redirect_url:window.origin+"/aura-h5/pay-success?order_num="}).then(e=>{if("string"===typeof e){const t=document.createElement("div");t.innerHTML=e,document.body.appendChild(t),document.forms[0].submit()}else"object"===typeof e&&3===e.status?i(e.msg):"object"===typeof e&&4===e.status&&Object(H["a"])(e.msg)})},h=Object(n["computed"])(()=>W["a"].state.isWechat),v=Object(n["computed"])(()=>h.value?!!localStorage.OPENID:!!localStorage.userInfo),g=()=>s();return Object(n["onMounted"])(()=>{s(),t.query.isAlert&&"1"===t.query.isAlert&&ve.confirm({title:"提示",message:"请确认微信支付是否已经完成",confirmButtonText:"已完成支付",cancelButtonText:"重新支付"}).then(()=>{Object(ye["h"])({order_num:t.query.order_num}).then(o=>{1===o.status&&e.push({name:"pay-success",query:{order_num:t.query.order_num}})})}).catch(()=>{O()})}),{code:r,checked:o,ruleShow:c,payChoose:a,wechat:h,RULESHOW:v,...Object(n["toRefs"])(l),routerJump:i,handleBuy:d,getWxCode:b,wxpayRequest:m,wechatPay:u,getWxH5:O,getWxJSSDK:p,onBridgeReady:f,alipay:j,finish:g}}}),Ce=(o("d59b"),o("6b0d")),_e=o.n(Ce);const Ve=_e()(we,[["render",q],["__scopeId","data-v-3f20e2da"]]);t["default"]=Ve},"70f9":function(e,t,o){},7336:function(e,t,o){"use strict";var n=o("7a23");const c={class:"modify-name-content"},a=["innerHTML"],r={class:"handle-btn"},l=Object(n["createTextVNode"])("确定");function s(e,t,o,s,i,d){const u=Object(n["resolveComponent"])("van-button"),b=Object(n["resolveComponent"])("van-popup");return Object(n["openBlock"])(),Object(n["createBlock"])(b,{class:"modify-name",show:e.dialog,"onUpdate:show":t[0]||(t[0]=t=>e.dialog=t),round:"","close-on-click-overlay":!1,onClose:e.close},{default:Object(n["withCtx"])(()=>[Object(n["createElementVNode"])("div",c,[Object(n["createElementVNode"])("div",{class:"desc",innerHTML:e.rich},null,8,a),Object(n["createElementVNode"])("div",r,[Object(n["createVNode"])(u,{plain:"",type:"primary",onClick:e.close},{default:Object(n["withCtx"])(()=>[l]),_:1},8,["onClick"])])])]),_:1},8,["show","onClose"])}var i=Object(n["defineComponent"])({name:"modify-name-popup",props:{show:{type:Boolean,default:()=>!1},rich:{type:String,default:()=>""}},setup(e,{emit:t}){const o=Object(n["ref"])(!1),c=()=>t("onClose");return Object(n["watchEffect"])(()=>{o.value=e.show}),{dialog:o,close:c}}}),d=(o("16f8"),o("6b0d")),u=o.n(d);const b=u()(i,[["render",s],["__scopeId","data-v-eecd9488"]]);t["a"]=b},cf45:function(e,t,o){"use strict";o.d(t,"a",(function(){return n})),o.d(t,"b",(function(){return c}));const n=e=>{var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),o=window.location.search.substr(1).match(t);return null!=o?unescape(o[2]):null},c=e=>{let t=/^(13[0-9]|14[01456879]|15[0-35-9]|16[2567]|17[0-8]|18[0-9]|19[0-35-9])\d{8}$/;return!t.test(e)}},d59b:function(e,t,o){"use strict";o("1c79")}}]);